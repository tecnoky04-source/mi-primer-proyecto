server {
    listen 80;
    server_name example.com; # production/testing domain

    # Serve static files directly
    location /static/ {
        # El path contiene un espacio; escapar el espacio como \040 para que nginx lo acepte.
        alias /home/vladtrix/DOCUEXPRESS\040PAGINA/static/;
        access_log off;
        expires max;
    }

    location / {
        # Proxy to systemd socket created by docuexpress_gunicorn.socket
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
        proxy_pass http://unix:/run/gunicorn-docuexpress.sock;
        proxy_redirect off;
        proxy_read_timeout 120;
    }

    # Optional: redirect HTTP -> HTTPS (enable when SSL configured)
    # return 301 https://$host$request_uri;
}

# Notes:
# - Replace `example.com` with your domain. If you use a bare IP, set server_name to `_`.
# - After placing this file in `/etc/nginx/sites-available/`, create a symlink in
#   `/etc/nginx/sites-enabled/` and test `nginx -t` before reloading.
# - For SSL, use Certbot to obtain certs and update this config to listen on 443.
# Socket permissions note:
# - The systemd socket `docuexpress_gunicorn.socket` creates `/run/gunicorn-docuexpress.sock`.
#   Ensure the socket group matches Nginx (usually `www-data`) so Nginx can access it. The
#   provided socket file sets `SocketGroup=www-data`. If you change system users, update that.
